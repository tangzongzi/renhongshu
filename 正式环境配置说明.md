# 正式环境配置说明

## ✅ 已完成修改

### 移除所有模拟数据
- ❌ 删除了模拟数据降级方案
- ✅ 只使用真实API调用
- ✅ API失败时显示详细错误信息
- ✅ 超时设置：内容抓取10秒，AI改写15秒

### 错误处理优化
- API失败时会弹出错误提示
- 控制台输出详细的调试信息
- 自动返回输入页面，可以重试

## 🔧 EdgeOne必须配置

### 1. 环境变量（重要！）
在EdgeOne控制台 → 环境变量中添加：

```
变量名: ZHIPU_API_KEY
变量值: 5da539c561a24becb4d557372f20b7b9.xhDQrrOzEiXYlxQA
```

⚠️ **注意**：
- 变量名是 `ZHIPU_API_KEY`（不带VITE_前缀）
- 这是后端API使用的环境变量
- 前端.env文件中的VITE_ZHIPU_API_KEY已注释掉

### 2. 检查API Functions部署
确认3个API函数已成功部署：
- `/api/parse-link.ts`
- `/api/scrape-content.ts`
- `/api/rewrite.ts`

### 3. 检查路由配置
确认 `edgeone.json` 中的路由已生效

## 🧪 测试方法

### 1. 输入小红书链接测试
- 输入任意小红书链接
- 如果成功：会显示抓取的内容
- 如果失败：会弹出错误提示

### 2. 查看控制台日志（F12）
成功时显示：
```
✅ 调用真实API抓取内容
✅ 内容抓取成功
```

失败时显示：
```
❌ 内容抓取失败: [错误信息]
请检查EdgeOne控制台：
  1. API Functions是否部署成功
  2. 环境变量ZHIPU_API_KEY是否配置
  3. 路由配置是否正确
  4. 查看EdgeOne部署日志
```

## 📋 常见问题

### Q: 为什么会超时？
A: 可能原因：
1. EdgeOne API Functions未部署成功
2. 小红书网站响应慢或被限制
3. 网络连接问题

### Q: 如何确认API是否正常？
A: 在浏览器控制台运行：
```javascript
fetch('/api/scrape-content', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ postId: '123456' })
})
.then(r => r.json())
.then(console.log)
```

如果返回 `{success: true, data: {...}}`，说明API正常。

### Q: 底部提示如何删除？
A: 已在index.html中添加CSS隐藏规则。如果仍然显示，需要在EdgeOne控制台检查是否有"演示模式"开关。

## 🚀 当前工作流程

1. 用户输入小红书链接
2. 调用 `/api/scrape-content` 抓取真实内容（10秒超时）
3. 成功：显示内容 / 失败：显示错误并返回
4. 用户点击"开始改写"
5. 调用 `/api/rewrite` 进行AI改写（15秒超时）
6. 成功：显示改写结果 / 失败：显示错误
7. 引导用户发布

## ⚠️ 重要提示

- **不再有模拟数据**：所有数据都来自真实API
- **必须配置EdgeOne**：否则应用无法正常工作
- **查看控制台**：所有错误信息都会在控制台输出
- **检查部署日志**：EdgeOne控制台可以查看API部署状态
